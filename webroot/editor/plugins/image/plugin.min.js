tinymce.PluginManager.add("image",function(e){function t(){function t(e){var t,r,a,s;t=n.find("#width")[0],r=n.find("#height")[0],a=t.value(),s=r.value(),n.find("#constrain")[0].checked()&&i&&o&&a&&s&&(e.control==t?(s=Math.round(a/i*s),r.value(s)):(a=Math.round(s/o*a),t.value(a))),i=a,o=s}var n,r,i,o,a=e.dom,s=e.selection.getNode();i=a.getAttrib(s,"width"),o=a.getAttrib(s,"height"),"IMG"!=s.nodeName||s.getAttribute("data-mce-object")?s=null:r={src:a.getAttrib(s,"src"),alt:a.getAttrib(s,"alt"),width:i,height:o},n=e.windowManager.open({title:"Edit image",data:r,body:[{name:"src",type:"filepicker",filetype:"image",label:"Source",autofocus:!0},{name:"alt",type:"textbox",label:"Image description"},{type:"container",label:"Dimensions",layout:"flex",direction:"row",align:"center",spacing:5,items:[{name:"width",type:"textbox",maxLength:3,size:3,onchange:t},{type:"label",text:"x"},{name:"height",type:"textbox",maxLength:3,size:3,onchange:t},{name:"constrain",type:"checkbox",checked:!0,text:"Constrain proportions"}]}],onSubmit:function(t){var n=t.data;""===n.width&&delete n.width,""===n.height&&delete n.height,s?a.setAttribs(s,n):e.insertContent(a.createHTML("img",n))}})}e.addButton("image",{icon:"image",tooltip:"Insert/edit image",onclick:t,stateSelector:"img:not([data-mce-object])"}),e.addMenuItem("image",{icon:"image",text:"Insert image",onclick:t,context:"insert",prependToContext:!0})});